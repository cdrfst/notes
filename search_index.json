{"index":{"version":"0.5.12","fields":[{"name":"title","boost":10},{"name":"keywords","boost":15},{"name":"body","boost":1}],"ref":"url","documentStore":{"store":{"./":["introduct"],"1-1/mr.html":["1.1.但通过将text类型的数据直接输出后发现并没有按预期排序，发现text虽然实现了writablecomparable接口，但其是按字典排序的，所以在mapper里将数据转换为integer类型后输出:","1.把所有文件数据整体升序排列,直接利用mr对key的默认排序功能","2.在reducer里得到的就是排序后的结果了,因为key有重复的所以需要遍历values来拿到所有key,再加上一个自增变量当成序号列,按需求列顺序输出","3.保证reducetask数量是1个(默认)","mr的排序","思路：","标题1"],"1-2/hive-1.html":["\"",",当前值比前后两个值小即波谷","0为不足30分钟的记录","1.使用","1.创建基础数据","1.将当前值","1.找出全部夺得3连贯的队伍","1.行函数计算出相邻两条记录的时间差(分钟)","1为超过30分钟的记录","2.year","2.如果当前值比前后两个值大即波峰","2.找出每个id在在一天之内所有的波峰与波谷值","2.按用户分区按dt升序算出每行的最大及最小值、用户步长","2.标记两次浏览之间时间间隔超过30分钟的记录","2020/09/12","3.1.每个id浏览时长、步长","3.2.如果两次浏览之间的间隔超过30分钟，认为是两个不同的浏览时间；再求每个id浏","3.写sql","3.取用户最后一次访问时间所在行的最大和最小值","3.按用户id","3.根据求得的gid，作为分组条件，求最终结果","4.将单位转为分钟显示","=","count","flag","gid，得到gid作为后面分组计算的依据","hive","lag","lead","price","row_numb","rownum","sum(diff)","不支持且输入参数必须到秒,所以在基础数据中直接将\"/“替换成\"","分组","前一个值","后一个值","和","在组内给数据编号(rownum)","如用flag列","并在后面拼了':00'","思路：","思路：属于连续值的求解：","思路：此题测试数据为一天的数据,所以根据要求将同一用户最后一次访问时间","按用户id分区后再按时间倒序,因unix_timestamp对","放在同一行","时长,count(id)","步长","然后相减：","计算","进行减运算","首次访问时间放在一行"]},"length":3},"tokenStore":{"root":{"0":{"docs":{},"为":{"docs":{},"不":{"docs":{},"足":{"3":{"0":{"docs":{},"分":{"docs":{},"钟":{"docs":{},"的":{"docs":{},"记":{"docs":{},"录":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}}},"docs":{}},"docs":{}}}}},"1":{"docs":{},".":{"1":{"docs":{},".":{"docs":{},"但":{"docs":{},"通":{"docs":{},"过":{"docs":{},"将":{"docs":{},"t":{"docs":{},"e":{"docs":{},"x":{"docs":{},"t":{"docs":{},"类":{"docs":{},"型":{"docs":{},"的":{"docs":{},"数":{"docs":{},"据":{"docs":{},"直":{"docs":{},"接":{"docs":{},"输":{"docs":{},"出":{"docs":{},"后":{"docs":{},"发":{"docs":{},"现":{"docs":{},"并":{"docs":{},"没":{"docs":{},"有":{"docs":{},"按":{"docs":{},"预":{"docs":{},"期":{"docs":{},"排":{"docs":{},"序":{"docs":{},"，":{"docs":{},"发":{"docs":{},"现":{"docs":{},"t":{"docs":{},"e":{"docs":{},"x":{"docs":{},"t":{"docs":{},"虽":{"docs":{},"然":{"docs":{},"实":{"docs":{},"现":{"docs":{},"了":{"docs":{},"w":{"docs":{},"r":{"docs":{},"i":{"docs":{},"t":{"docs":{},"a":{"docs":{},"b":{"docs":{},"l":{"docs":{},"e":{"docs":{},"c":{"docs":{},"o":{"docs":{},"m":{"docs":{},"p":{"docs":{},"a":{"docs":{},"r":{"docs":{},"a":{"docs":{},"b":{"docs":{},"l":{"docs":{},"e":{"docs":{},"接":{"docs":{},"口":{"docs":{},"，":{"docs":{},"但":{"docs":{},"其":{"docs":{},"是":{"docs":{},"按":{"docs":{},"字":{"docs":{},"典":{"docs":{},"排":{"docs":{},"序":{"docs":{},"的":{"docs":{},"，":{"docs":{},"所":{"docs":{},"以":{"docs":{},"在":{"docs":{},"m":{"docs":{},"a":{"docs":{},"p":{"docs":{},"p":{"docs":{},"e":{"docs":{},"r":{"docs":{},"里":{"docs":{},"将":{"docs":{},"数":{"docs":{},"据":{"docs":{},"转":{"docs":{},"换":{"docs":{},"为":{"docs":{},"i":{"docs":{},"n":{"docs":{},"t":{"docs":{},"e":{"docs":{},"g":{"docs":{},"e":{"docs":{},"r":{"docs":{},"类":{"docs":{},"型":{"docs":{},"后":{"docs":{},"输":{"docs":{},"出":{"docs":{},":":{"docs":{"1-1/mr.html":{"ref":"1-1/mr.html","tf":0.16666666666666666}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"docs":{},"把":{"docs":{},"所":{"docs":{},"有":{"docs":{},"文":{"docs":{},"件":{"docs":{},"数":{"docs":{},"据":{"docs":{},"整":{"docs":{},"体":{"docs":{},"升":{"docs":{},"序":{"docs":{},"排":{"docs":{},"列":{"docs":{},",":{"docs":{},"直":{"docs":{},"接":{"docs":{},"利":{"docs":{},"用":{"docs":{},"m":{"docs":{},"r":{"docs":{},"对":{"docs":{},"k":{"docs":{},"e":{"docs":{},"y":{"docs":{},"的":{"docs":{},"默":{"docs":{},"认":{"docs":{},"排":{"docs":{},"序":{"docs":{},"功":{"docs":{},"能":{"docs":{"1-1/mr.html":{"ref":"1-1/mr.html","tf":0.16666666666666666}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"使":{"docs":{},"用":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}},"创":{"docs":{},"建":{"docs":{},"基":{"docs":{},"础":{"docs":{},"数":{"docs":{},"据":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}}},"将":{"docs":{},"当":{"docs":{},"前":{"docs":{},"值":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}},"找":{"docs":{},"出":{"docs":{},"全":{"docs":{},"部":{"docs":{},"夺":{"docs":{},"得":{"3":{"docs":{},"连":{"docs":{},"贯":{"docs":{},"的":{"docs":{},"队":{"docs":{},"伍":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}}},"docs":{}}}}}}},"行":{"docs":{},"函":{"docs":{},"数":{"docs":{},"计":{"docs":{},"算":{"docs":{},"出":{"docs":{},"相":{"docs":{},"邻":{"docs":{},"两":{"docs":{},"条":{"docs":{},"记":{"docs":{},"录":{"docs":{},"的":{"docs":{},"时":{"docs":{},"间":{"docs":{},"差":{"docs":{},"(":{"docs":{},"分":{"docs":{},"钟":{"docs":{},")":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}}}}}}}}}}}}}}}}}},"为":{"docs":{},"超":{"docs":{},"过":{"3":{"0":{"docs":{},"分":{"docs":{},"钟":{"docs":{},"的":{"docs":{},"记":{"docs":{},"录":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}}},"docs":{}},"docs":{}}}}},"2":{"0":{"2":{"0":{"docs":{},"/":{"0":{"9":{"docs":{},"/":{"1":{"2":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}},"docs":{}},"docs":{}}},"docs":{}},"docs":{}}},"docs":{}},"docs":{}},"docs":{},".":{"docs":{},"在":{"docs":{},"r":{"docs":{},"e":{"docs":{},"d":{"docs":{},"u":{"docs":{},"c":{"docs":{},"e":{"docs":{},"r":{"docs":{},"里":{"docs":{},"得":{"docs":{},"到":{"docs":{},"的":{"docs":{},"就":{"docs":{},"是":{"docs":{},"排":{"docs":{},"序":{"docs":{},"后":{"docs":{},"的":{"docs":{},"结":{"docs":{},"果":{"docs":{},"了":{"docs":{},",":{"docs":{},"因":{"docs":{},"为":{"docs":{},"k":{"docs":{},"e":{"docs":{},"y":{"docs":{},"有":{"docs":{},"重":{"docs":{},"复":{"docs":{},"的":{"docs":{},"所":{"docs":{},"以":{"docs":{},"需":{"docs":{},"要":{"docs":{},"遍":{"docs":{},"历":{"docs":{},"v":{"docs":{},"a":{"docs":{},"l":{"docs":{},"u":{"docs":{},"e":{"docs":{},"s":{"docs":{},"来":{"docs":{},"拿":{"docs":{},"到":{"docs":{},"所":{"docs":{},"有":{"docs":{},"k":{"docs":{},"e":{"docs":{},"y":{"docs":{},",":{"docs":{},"再":{"docs":{},"加":{"docs":{},"上":{"docs":{},"一":{"docs":{},"个":{"docs":{},"自":{"docs":{},"增":{"docs":{},"变":{"docs":{},"量":{"docs":{},"当":{"docs":{},"成":{"docs":{},"序":{"docs":{},"号":{"docs":{},"列":{"docs":{},",":{"docs":{},"按":{"docs":{},"需":{"docs":{},"求":{"docs":{},"列":{"docs":{},"顺":{"docs":{},"序":{"docs":{},"输":{"docs":{},"出":{"docs":{"1-1/mr.html":{"ref":"1-1/mr.html","tf":0.16666666666666666}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"y":{"docs":{},"e":{"docs":{},"a":{"docs":{},"r":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}},"如":{"docs":{},"果":{"docs":{},"当":{"docs":{},"前":{"docs":{},"值":{"docs":{},"比":{"docs":{},"前":{"docs":{},"后":{"docs":{},"两":{"docs":{},"个":{"docs":{},"值":{"docs":{},"大":{"docs":{},"即":{"docs":{},"波":{"docs":{},"峰":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}}}}}}}}}}}},"找":{"docs":{},"出":{"docs":{},"每":{"docs":{},"个":{"docs":{},"i":{"docs":{},"d":{"docs":{},"在":{"docs":{},"在":{"docs":{},"一":{"docs":{},"天":{"docs":{},"之":{"docs":{},"内":{"docs":{},"所":{"docs":{},"有":{"docs":{},"的":{"docs":{},"波":{"docs":{},"峰":{"docs":{},"与":{"docs":{},"波":{"docs":{},"谷":{"docs":{},"值":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}}}}}}}}}}}}}}}}}},"按":{"docs":{},"用":{"docs":{},"户":{"docs":{},"分":{"docs":{},"区":{"docs":{},"按":{"docs":{},"d":{"docs":{},"t":{"docs":{},"升":{"docs":{},"序":{"docs":{},"算":{"docs":{},"出":{"docs":{},"每":{"docs":{},"行":{"docs":{},"的":{"docs":{},"最":{"docs":{},"大":{"docs":{},"及":{"docs":{},"最":{"docs":{},"小":{"docs":{},"值":{"docs":{},"、":{"docs":{},"用":{"docs":{},"户":{"docs":{},"步":{"docs":{},"长":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}}}}}}}}}}}}}}}}}}}}}}},"标":{"docs":{},"记":{"docs":{},"两":{"docs":{},"次":{"docs":{},"浏":{"docs":{},"览":{"docs":{},"之":{"docs":{},"间":{"docs":{},"时":{"docs":{},"间":{"docs":{},"间":{"docs":{},"隔":{"docs":{},"超":{"docs":{},"过":{"3":{"0":{"docs":{},"分":{"docs":{},"钟":{"docs":{},"的":{"docs":{},"记":{"docs":{},"录":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}}},"docs":{}},"docs":{}}}}}}}}}}}}}}}}},"3":{"docs":{},".":{"1":{"docs":{},".":{"docs":{},"每":{"docs":{},"个":{"docs":{},"i":{"docs":{},"d":{"docs":{},"浏":{"docs":{},"览":{"docs":{},"时":{"docs":{},"长":{"docs":{},"、":{"docs":{},"步":{"docs":{},"长":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}}}}}}}}}},"2":{"docs":{},".":{"docs":{},"如":{"docs":{},"果":{"docs":{},"两":{"docs":{},"次":{"docs":{},"浏":{"docs":{},"览":{"docs":{},"之":{"docs":{},"间":{"docs":{},"的":{"docs":{},"间":{"docs":{},"隔":{"docs":{},"超":{"docs":{},"过":{"3":{"0":{"docs":{},"分":{"docs":{},"钟":{"docs":{},"，":{"docs":{},"认":{"docs":{},"为":{"docs":{},"是":{"docs":{},"两":{"docs":{},"个":{"docs":{},"不":{"docs":{},"同":{"docs":{},"的":{"docs":{},"浏":{"docs":{},"览":{"docs":{},"时":{"docs":{},"间":{"docs":{},"；":{"docs":{},"再":{"docs":{},"求":{"docs":{},"每":{"docs":{},"个":{"docs":{},"i":{"docs":{},"d":{"docs":{},"浏":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}}}}}}}}}}}}}}}}}}}}},"docs":{}},"docs":{}}}}}}}}}}}}}}}},"docs":{},"保":{"docs":{},"证":{"docs":{},"r":{"docs":{},"e":{"docs":{},"d":{"docs":{},"u":{"docs":{},"c":{"docs":{},"e":{"docs":{},"t":{"docs":{},"a":{"docs":{},"s":{"docs":{},"k":{"docs":{},"数":{"docs":{},"量":{"docs":{},"是":{"1":{"docs":{},"个":{"docs":{},"(":{"docs":{},"默":{"docs":{},"认":{"docs":{},")":{"docs":{"1-1/mr.html":{"ref":"1-1/mr.html","tf":0.16666666666666666}}}}}}}},"docs":{}}}}}}}}}}}}}}}},"写":{"docs":{},"s":{"docs":{},"q":{"docs":{},"l":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}},"取":{"docs":{},"用":{"docs":{},"户":{"docs":{},"最":{"docs":{},"后":{"docs":{},"一":{"docs":{},"次":{"docs":{},"访":{"docs":{},"问":{"docs":{},"时":{"docs":{},"间":{"docs":{},"所":{"docs":{},"在":{"docs":{},"行":{"docs":{},"的":{"docs":{},"最":{"docs":{},"大":{"docs":{},"和":{"docs":{},"最":{"docs":{},"小":{"docs":{},"值":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}}}}}}}}}}}}}}}}}},"按":{"docs":{},"用":{"docs":{},"户":{"docs":{},"i":{"docs":{},"d":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}},"根":{"docs":{},"据":{"docs":{},"求":{"docs":{},"得":{"docs":{},"的":{"docs":{},"g":{"docs":{},"i":{"docs":{},"d":{"docs":{},"，":{"docs":{},"作":{"docs":{},"为":{"docs":{},"分":{"docs":{},"组":{"docs":{},"条":{"docs":{},"件":{"docs":{},"，":{"docs":{},"求":{"docs":{},"最":{"docs":{},"终":{"docs":{},"结":{"docs":{},"果":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}}}}}}}}}}}}}}}}}}}},"4":{"docs":{},".":{"docs":{},"将":{"docs":{},"单":{"docs":{},"位":{"docs":{},"转":{"docs":{},"为":{"docs":{},"分":{"docs":{},"钟":{"docs":{},"显":{"docs":{},"示":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}}}}}}}},"docs":{},"i":{"docs":{},"n":{"docs":{},"t":{"docs":{},"r":{"docs":{},"o":{"docs":{},"d":{"docs":{},"u":{"docs":{},"c":{"docs":{},"t":{"docs":{"./":{"ref":"./","tf":11}}}}}}}}}}},"m":{"docs":{},"r":{"docs":{},"的":{"docs":{},"排":{"docs":{},"序":{"docs":{"1-1/mr.html":{"ref":"1-1/mr.html","tf":10}}}}}}},"思":{"docs":{},"路":{"docs":{},"：":{"docs":{"1-1/mr.html":{"ref":"1-1/mr.html","tf":0.16666666666666666},"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.037037037037037035}},"属":{"docs":{},"于":{"docs":{},"连":{"docs":{},"续":{"docs":{},"值":{"docs":{},"的":{"docs":{},"求":{"docs":{},"解":{"docs":{},"：":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}}}}}},"此":{"docs":{},"题":{"docs":{},"测":{"docs":{},"试":{"docs":{},"数":{"docs":{},"据":{"docs":{},"为":{"docs":{},"一":{"docs":{},"天":{"docs":{},"的":{"docs":{},"数":{"docs":{},"据":{"docs":{},",":{"docs":{},"所":{"docs":{},"以":{"docs":{},"根":{"docs":{},"据":{"docs":{},"要":{"docs":{},"求":{"docs":{},"将":{"docs":{},"同":{"docs":{},"一":{"docs":{},"用":{"docs":{},"户":{"docs":{},"最":{"docs":{},"后":{"docs":{},"一":{"docs":{},"次":{"docs":{},"访":{"docs":{},"问":{"docs":{},"时":{"docs":{},"间":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"标":{"docs":{},"题":{"1":{"docs":{"1-1/mr.html":{"ref":"1-1/mr.html","tf":0.16666666666666666}}},"docs":{}}},"\"":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}},",":{"docs":{},"当":{"docs":{},"前":{"docs":{},"值":{"docs":{},"比":{"docs":{},"前":{"docs":{},"后":{"docs":{},"两":{"docs":{},"个":{"docs":{},"值":{"docs":{},"小":{"docs":{},"即":{"docs":{},"波":{"docs":{},"谷":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}}}}}}}}}}},"=":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}},"c":{"docs":{},"o":{"docs":{},"u":{"docs":{},"n":{"docs":{},"t":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}},"f":{"docs":{},"l":{"docs":{},"a":{"docs":{},"g":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}},"g":{"docs":{},"i":{"docs":{},"d":{"docs":{},"，":{"docs":{},"得":{"docs":{},"到":{"docs":{},"g":{"docs":{},"i":{"docs":{},"d":{"docs":{},"作":{"docs":{},"为":{"docs":{},"后":{"docs":{},"面":{"docs":{},"分":{"docs":{},"组":{"docs":{},"计":{"docs":{},"算":{"docs":{},"的":{"docs":{},"依":{"docs":{},"据":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}}}}}}}}}}}}}}}}},"h":{"docs":{},"i":{"docs":{},"v":{"docs":{},"e":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":10.018518518518519}}}}}},"l":{"docs":{},"a":{"docs":{},"g":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}},"e":{"docs":{},"a":{"docs":{},"d":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}},"p":{"docs":{},"r":{"docs":{},"i":{"docs":{},"c":{"docs":{},"e":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}},"r":{"docs":{},"o":{"docs":{},"w":{"docs":{},"_":{"docs":{},"n":{"docs":{},"u":{"docs":{},"m":{"docs":{},"b":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}},"n":{"docs":{},"u":{"docs":{},"m":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}}},"s":{"docs":{},"u":{"docs":{},"m":{"docs":{},"(":{"docs":{},"d":{"docs":{},"i":{"docs":{},"f":{"docs":{},"f":{"docs":{},")":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}}}}}},"不":{"docs":{},"支":{"docs":{},"持":{"docs":{},"且":{"docs":{},"输":{"docs":{},"入":{"docs":{},"参":{"docs":{},"数":{"docs":{},"必":{"docs":{},"须":{"docs":{},"到":{"docs":{},"秒":{"docs":{},",":{"docs":{},"所":{"docs":{},"以":{"docs":{},"在":{"docs":{},"基":{"docs":{},"础":{"docs":{},"数":{"docs":{},"据":{"docs":{},"中":{"docs":{},"直":{"docs":{},"接":{"docs":{},"将":{"docs":{},"\"":{"docs":{},"/":{"docs":{},"“":{"docs":{},"替":{"docs":{},"换":{"docs":{},"成":{"docs":{},"\"":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"分":{"docs":{},"组":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}},"前":{"docs":{},"一":{"docs":{},"个":{"docs":{},"值":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}},"后":{"docs":{},"一":{"docs":{},"个":{"docs":{},"值":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}},"和":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.037037037037037035}}},"在":{"docs":{},"组":{"docs":{},"内":{"docs":{},"给":{"docs":{},"数":{"docs":{},"据":{"docs":{},"编":{"docs":{},"号":{"docs":{},"(":{"docs":{},"r":{"docs":{},"o":{"docs":{},"w":{"docs":{},"n":{"docs":{},"u":{"docs":{},"m":{"docs":{},")":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}}}}}}}}}}}}},"如":{"docs":{},"用":{"docs":{},"f":{"docs":{},"l":{"docs":{},"a":{"docs":{},"g":{"docs":{},"列":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}}}},"并":{"docs":{},"在":{"docs":{},"后":{"docs":{},"面":{"docs":{},"拼":{"docs":{},"了":{"docs":{},"'":{"docs":{},":":{"0":{"0":{"docs":{},"'":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}},"docs":{}},"docs":{}}}}}}}}},"按":{"docs":{},"用":{"docs":{},"户":{"docs":{},"i":{"docs":{},"d":{"docs":{},"分":{"docs":{},"区":{"docs":{},"后":{"docs":{},"再":{"docs":{},"按":{"docs":{},"时":{"docs":{},"间":{"docs":{},"倒":{"docs":{},"序":{"docs":{},",":{"docs":{},"因":{"docs":{},"u":{"docs":{},"n":{"docs":{},"i":{"docs":{},"x":{"docs":{},"_":{"docs":{},"t":{"docs":{},"i":{"docs":{},"m":{"docs":{},"e":{"docs":{},"s":{"docs":{},"t":{"docs":{},"a":{"docs":{},"m":{"docs":{},"p":{"docs":{},"对":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"放":{"docs":{},"在":{"docs":{},"同":{"docs":{},"一":{"docs":{},"行":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}},"时":{"docs":{},"长":{"docs":{},",":{"docs":{},"c":{"docs":{},"o":{"docs":{},"u":{"docs":{},"n":{"docs":{},"t":{"docs":{},"(":{"docs":{},"i":{"docs":{},"d":{"docs":{},")":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}}}}}}}}},"步":{"docs":{},"长":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}},"然":{"docs":{},"后":{"docs":{},"相":{"docs":{},"减":{"docs":{},"：":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}},"计":{"docs":{},"算":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}},"进":{"docs":{},"行":{"docs":{},"减":{"docs":{},"运":{"docs":{},"算":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}},"首":{"docs":{},"次":{"docs":{},"访":{"docs":{},"问":{"docs":{},"时":{"docs":{},"间":{"docs":{},"放":{"docs":{},"在":{"docs":{},"一":{"docs":{},"行":{"docs":{"1-2/hive-1.html":{"ref":"1-2/hive-1.html","tf":0.018518518518518517}}}}}}}}}}}}},"length":60},"corpusTokens":["\"",",当前值比前后两个值小即波谷","0为不足30分钟的记录","1.1.但通过将text类型的数据直接输出后发现并没有按预期排序，发现text虽然实现了writablecomparable接口，但其是按字典排序的，所以在mapper里将数据转换为integer类型后输出:","1.使用","1.创建基础数据","1.将当前值","1.找出全部夺得3连贯的队伍","1.把所有文件数据整体升序排列,直接利用mr对key的默认排序功能","1.行函数计算出相邻两条记录的时间差(分钟)","1为超过30分钟的记录","2.year","2.在reducer里得到的就是排序后的结果了,因为key有重复的所以需要遍历values来拿到所有key,再加上一个自增变量当成序号列,按需求列顺序输出","2.如果当前值比前后两个值大即波峰","2.找出每个id在在一天之内所有的波峰与波谷值","2.按用户分区按dt升序算出每行的最大及最小值、用户步长","2.标记两次浏览之间时间间隔超过30分钟的记录","2020/09/12","3.1.每个id浏览时长、步长","3.2.如果两次浏览之间的间隔超过30分钟，认为是两个不同的浏览时间；再求每个id浏","3.保证reducetask数量是1个(默认)","3.写sql","3.取用户最后一次访问时间所在行的最大和最小值","3.按用户id","3.根据求得的gid，作为分组条件，求最终结果","4.将单位转为分钟显示","=","count","flag","gid，得到gid作为后面分组计算的依据","hive","introduct","lag","lead","mr的排序","price","row_numb","rownum","sum(diff)","不支持且输入参数必须到秒,所以在基础数据中直接将\"/“替换成\"","分组","前一个值","后一个值","和","在组内给数据编号(rownum)","如用flag列","并在后面拼了':00'","思路：","思路：属于连续值的求解：","思路：此题测试数据为一天的数据,所以根据要求将同一用户最后一次访问时间","按用户id分区后再按时间倒序,因unix_timestamp对","放在同一行","时长,count(id)","标题1","步长","然后相减：","计算","进行减运算","首次访问时间放在一行"],"pipeline":["stopWordFilter","stemmer"]},"store":{"./":{"url":"./","title":"Introduction","keywords":"","body":"Introduction\n"},"1-1/mr.html":{"url":"1-1/mr.html","title":"MR的排序","keywords":"","body":"标题1\n思路：\n1.把所有文件数据整体升序排列,直接利用mr对key的默认排序功能\n1.1.但通过将Text类型的数据直接输出后发现并没有按预期排序，发现Text虽然实现了WritableComparable接口，但其是按字典排序的，所以在Mapper里将数据转换为Integer类型后输出:\n\n2.在Reducer里得到的就是排序后的结果了,因为key有重复的所以需要遍历values来拿到所有key,再加上一个自增变量当成序号列,按需求列顺序输出\n\n3.保证reduceTask数量是1个(默认)\n"},"1-2/hive-1.html":{"url":"1-2/hive-1.html","title":"Hive","keywords":"","body":"Hive\n1.找出全部夺得3连贯的队伍\n思路：属于连续值的求解：\n\n1.使用 row_number 在组内给数据编号(rownum) \n2.year - rownum = gid，得到gid作为后面分组计算的依据 \n3.根据求得的gid，作为分组条件，求最终结果\n\n\n2.找出每个id在在一天之内所有的波峰与波谷值\n思路：\n\n1.将当前值 price  前一个值 lag  后一个值 lead 放在同一行\n2.如果当前值比前后两个值大即波峰 ,当前值比前后两个值小即波谷 \n\n\n3.写SQL\n3.1.每个id浏览时长、步长\n思路：此题测试数据为一天的数据,所以根据要求将同一用户最后一次访问时间 和 首次访问时间放在一行 然后相减：\n\n1.创建基础数据 按用户id分区后再按时间倒序,因unix_timestamp对 2020/09/12 不支持且输入参数必须到秒,所以在基础数据中直接将\"/“替换成\"-\" 并在后面拼了':00'\n2.按用户分区按dt升序算出每行的最大及最小值、用户步长 count \n3.取用户最后一次访问时间所在行的最大和最小值 进行减运算\n4.将单位转为分钟显示\n\n\n3.2.如果两次浏览之间的间隔超过30分钟，认为是两个不同的浏览时间；再求每个id浏\n思路：\n\n1.行函数计算出相邻两条记录的时间差(分钟)\n2.标记两次浏览之间时间间隔超过30分钟的记录 如用flag列 1为超过30分钟的记录 0为不足30分钟的记录\n3.按用户id 和 flag 分组 计算 sum(diff) 时长,count(id) 步长\n\n\n"}}}